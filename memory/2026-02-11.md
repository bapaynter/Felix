# Session 2026-02-11

## User Preferences - Casual Capture
- User wants proactive memory capture during conversations
- User prefers check-ins every 3 hours (updated from 8h)
- User wants casual details captured in daily memory file
- User wants midnight UTC cron for memory processing (6 PM their time)
- User wants me to be more proactive about remembering things
- User likes explicit announcements when memory files are updated
- User wants full autonomy in memory decisions - I decide what's worth keeping
- User asked me to suggest improvements for myself/host machine
- **Clarified:** Stand-up meeting is at 10 AM local time (GMT-6), NOT 4 PM - calendar check showed 4 PM UTC which needs timezone conversion
- **NOTE:** Gateway needs restart after updating `.openclaw-env` for changes to take effect (e.g., new API keys like BRAVE_API_KEY)

## Todoist API - FIXED
- **Issue:** Both v1 and v2 APIs returning 404/410 errors
- **Fix:** Updated todoist.sh to use v1 Sync API with commands array
- **Working API:** `https://api.todoist.com/api/v1/sync`
- **Script:** `/home/pi/.openclaw/workspace/skills/todoist/scripts/todoist.sh`
- **Created 8 improvement tasks in AI Work project**
- **Project IDs documented:** AI Tasks (6fxHh9H9JGJv7V65), TV Shows (6fxpQcCrqwRXCwVw), Movies (6fxpQchM4gJfWHwP)
- **Task format:** Use commands array in sync endpoint, not /items/add

## Memory Processing - NEW
- **Daily job:** Midnight UTC (6 PM user time) cron job
- **Script:** `bin/memory-process.mjs`
- **Full autonomy:** I decide what's worth adding to MEMORY.md
- **Captures:** Preferences, lessons, rules, identity/user updates

## Email Sorting - FIXED
- **Issue:** Sorter suppressing errors with `2>/dev/null`
- **Fix:** Removed error suppression, added verbose logging
- **Categories:** Dev, Support, Internal, Personal, GitHub, GhostInspector
- **Runs:** After every email check (every 5 min during 9 AM - 9 PM)

## Heartbeat System
- Heartbeat checks running every 5 minutes (5min interval)
- Calendar check ran at 08:03 UTC: 4 events today (In person work day x2, Daily Stand-Up 4 PM)
- Email check runs during active hours (9 AM - 9 PM), checks for unread emails with urgency filtering
- Todoist checks running 24/7 every 30 min
- Git status/update checks running silently in background

## State Changes
- Updated `/home/pi/.openclaw/workspace/bin/heartbeat-runner.mjs` - removed calendar sync, added AI work task detection
- Updated `/home/pi/.openclaw/workspace/HEARTBEAT.md` - documented new AI work task workflow
- Updated `/home/pi/.openclaw/workspace/skills/todoist/scripts/todoist.sh` - fixed v1 API usage
- Updated `/home/pi/.openclaw/workspace/bin/ai-sort-emails.mjs` - fixed error handling

## Lessons Learned
- Use v1 Sync API with commands array for Todoist (not /items/add endpoint)
- Never suppress errors with `2>/dev/null` - lose important debugging info
- User prefers full autonomy on memory decisions
- Proactive capture + midnight processing = good memory system

## To Do
- [x] Remove missing cal-sync.sh reference - DONE
- [x] Add AI work task detection to heartbeat - DONE
- [x] Fix Todoist API - DONE (v1 Sync API)
- [x] Fix email sorter - DONE (error handling)
- [x] Set up memory processing job - DONE (midnight UTC)
- [x] Create 8 improvement tasks - DONE